<!DOCTYPE html>
<html>
  <head>
  <title>Redshift Configuration</title>
    <meta name=viewport content="width=device-width, initial-scale=1" />
    <link rel='stylesheet' type='text/css' href='../../config/css/slate.min.css'>
    <link rel='stylesheet' type='text/css' href='../../config/css/fonts.css'>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:700" rel="stylesheet">
    <script src='../../config/js/slate.js'></script>
    <script src='../../config/js/gcolor.js'></script>
    <script src='../../config/js/pebble.js'></script>
    <script src='../../config/js/preview.js'></script>
    <script src='../../config/js/strftime.js'></script>
    <script src='../../config/js/sprintf.min.js'></script>
    <script src="../../config/js/spark-md5.min.js"></script>
    <style>
    canvas.preview {
      margin: 10px;
    }
    #data {
      display: none;
    }
    </style>
    <meta charset="utf-8"/>
  </head>

  <body>
    
    <div id="previews"></div>

<!--
// -- autogen
// -- ## for key in complications
// --     <canvas class="complication" id="canvas-complication-{{ key["id"] }}"></canvas>
// -- ## endfor
-->
    <canvas class="complication" id="canvas-complication-0"></canvas>
    <canvas class="complication" id="canvas-complication-1"></canvas>
    <canvas class="complication" id="canvas-complication-2"></canvas>
    <canvas class="complication" id="canvas-complication-3"></canvas>
    <canvas class="complication" id="canvas-complication-4"></canvas>
    <canvas class="complication" id="canvas-complication-5"></canvas>
    <canvas class="complication" id="canvas-complication-6"></canvas>
    <canvas class="complication" id="canvas-complication-7"></canvas>
    <canvas class="complication" id="canvas-complication-8"></canvas>
    <canvas class="complication" id="canvas-complication-9"></canvas>
    <canvas class="complication" id="canvas-complication-10"></canvas>
    <canvas class="complication" id="canvas-complication-11"></canvas>
    <canvas class="complication" id="canvas-complication-12"></canvas>
    <canvas class="complication" id="canvas-complication-13"></canvas>
    <canvas class="complication" id="canvas-complication-14"></canvas>
    <canvas class="complication" id="canvas-complication-15"></canvas>
    <canvas class="complication" id="canvas-complication-16"></canvas>
    <canvas class="complication" id="canvas-complication-17"></canvas>
    <canvas class="complication" id="canvas-complication-18"></canvas>
    <canvas class="complication" id="canvas-complication-19"></canvas>
    <canvas class="complication" id="canvas-complication-20"></canvas>
    <canvas class="complication" id="canvas-complication-21"></canvas>
    <canvas class="complication" id="canvas-complication-22"></canvas>
    <canvas class="complication" id="canvas-complication-23"></canvas>
    <canvas class="complication" id="canvas-complication-24"></canvas>
    <canvas class="complication" id="canvas-complication-25"></canvas>
    <canvas class="complication" id="canvas-complication-26"></canvas>
    <canvas class="complication" id="canvas-complication-27"></canvas>
    <canvas class="complication" id="canvas-complication-28"></canvas>
    <canvas class="complication" id="canvas-complication-29"></canvas>
<!--
// -- end autogen
-->

    <div id="data">
    </div>

  <script>
  
  var time = Math.round(new Date(2016, 5, 21, 22, 21, 54) / 1000);

  function colored(id, color) {
    return {
      id: id,
      state: {
        time: time,
      },
      config: {
        'SIMPLECONFIG_COLOR_ACCENT': color,
      }
    };
  }

  $(document).ready(function() {
    var config = RedshiftPreview.defaultConfig();
    var color_screenshots = [];
    var colors = [
      GColor.VividCerulean,
      GColor.BabyBlueEyes,
      GColor.LavenderIndigo,
      GColor.RichBrilliantLavender,
      GColor.Melon,
      GColor.Rajah,
      GColor.PastelYellow,
      GColor.Inchworm,
      GColor.MintGreen,
      GColor.MediumAquamarine,
      GColor.Celeste,
    ];
    var ncols = colors.length;
    for (var i = 0; i < ncols; i += 1) {
      var idx = (6 + i) % ncols;
      color_screenshots.push(colored('redshift-color-' + (i+1), colors[idx]))
    }
    var screenshots = [
      {
        id: "redshift-1",
        state: {
          time: time,
          bluetooth: true,
        },
      },
      {
        id: "redshift-2",
        state: {
          time: time,
          weather: {
            low: -10,
            now: -2,
            high: 2,
            icon: "h",
          },
          bluetooth: true,
        },
        config: {
          'SIMPLECONFIG_COLOR_ACCENT': GColor.Rajah,
          'CONFIG_WEATHER_UNIT_LOCAL': 1,
        }
      },
      {
        id: "redshift-3",
        state: {
          time: time,
          weather: {
            low: 5,
            now: 10,
            high: 17,
            icon: "f",
          },
          bluetooth: true,
        },
        config: {
          'SIMPLECONFIG_COLOR_MAIN': GColor.Black,
          'SIMPLECONFIG_COLOR_ACCENT': GColor.DarkCandyAppleRed,
          'SIMPLECONFIG_COLOR_BACKGROUND': GColor.White,
        }
      },
    ].concat(color_screenshots);

    for (var i in screenshots) {
      var key = "canvas-" + screenshots[i].id;
      $("#previews").append("<canvas class='preview' id=\"" + key + "\"></canvas>");
      RedshiftPreview.drawPreview(RedshiftPreview.overrideConfig(screenshots[i].config, config), key, "basalt", RedshiftPreview.override(screenshots[i].state, RedshiftPreview.defaultState()));
    }

    var complications = [];
// -- autogen
// --     var n_complications = {{ complications | length }};
    var n_complications = 30;
// -- end autogen
    for (i = 0; i < n_complications; i++) {
      var id = "complication-"+i;
      complications.push({ id: id, });
      RedshiftPreview.previewComplication(i, config, 'canvas-' + id, "basalt");
    }

    // schedule capturing the preview
    var capture = function () {

      var s = "";
      var all = screenshots.concat(complications);
      for (var i in all) {
        var id = all[i].id;
        var key = "canvas-" + id;
        var img    = $("#" + key).get(0).toDataURL("image/png");
        s += id + "::" + "::" + img.substr(22) + "\n";
      }

      $("#data").html(s);

      var timeout = 500;
      setTimeout(function () {
        capture();
      }, timeout);
    };
    capture();
  });
  </script>
  </body>
</html>
