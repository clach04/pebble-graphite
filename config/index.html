<!DOCTYPE html>
<html>
  <head>
  <title>Graphite Configuration</title>
    <meta name=viewport content="width=device-width, initial-scale=1" />
    <link rel='stylesheet' type='text/css' href='css/slate.min.css'>
    <link rel='stylesheet' type='text/css' href='css/fonts.css'>
    <link href="https://fonts.googleapis.com/css?family=Open+Sans+Condensed:700" rel="stylesheet">
    <script src='js/slate.js'></script>
    <script src='js/gcolor.js'></script>
    <script src='js/pebble.js'></script>
    <script src='js/preview.js'></script>
    <script src='js/strftime.js'></script>
    <script src='js/sprintf.min.js'></script>
    <script src="js/spark-md5.min.js"></script>
    <style>
    .noscroll { 
      overflow: hidden;
    }
    .title {
      padding-top: 20px;
      text-align: center;
    }
    .hidden {
      display: none;
    }
    canvas#preview {
      margin: 10px auto 5px;
      display: block;
    }
    #preview-container {
      position: fixed;
      z-index: 999;
      top: 0;
      left: 0;
      width: 100%;
      border-bottom: 1px solid #dedede;
      box-shadow: 0px 5px 5px rgba(0,0,0,0.12);
      background: #eaeaea;
    }
    #preview-container p {
      text-align: center;
      font-size: 11px;
    }
    .widget {
      border: 1px solid black;
    }
    #widgets-preview {
      display: none;
      position: fixed;
      left: 15px;
      right: 15px;
      top: 15px;
      bottom: 15px;
      max-width: 400px;
      z-index: 9999;
      background: #FFF;
      border: #666;
      padding: 15px;
      margin: auto;
      box-shadow: 0px 0px 30px rgba(0,0,0,0.7);
      overflow-y: scroll;
    }
    #widgets-preview .button-container {
      margin-top: 15px;
    }
    .widget-preview {
      border-top: 1px solid rgb(222, 222, 222);
      border-bottom: 1px solid rgb(222, 222, 222);
      padding: 5px 0;
    }
    table.format tr td:nth-child(1) {
      padding-right: 10px;
      font-family: monospace;
    }
    .item-container-footer {
      color: #555 !important;
    }
    #myprefs {
      color: #555;
    }
    #weather-warning {
      padding: 10px;
      border-top: 1px solid #F77;
      border-bottom: 1px solid #F77;
      background: #FDD;
    }
    </style>
    <meta charset="utf-8"/>
  </head>

  <body>
    <div id="preview-container">
      <canvas class="watchface" id="preview"></canvas>
      <p>Live preview</p>
    </div>

    <div id="body-container">

    <div id="weather-warning">
      <p>Warning: OpenWeatherMap does not provide hourly rain forecasts or low/high
      temperature information, so these will not work with OpenWeatherMap as the
      weather provider.  You can use darksky.net or Weather Underground instead
      by changing the setting below (requires a free API key).</p>
    </div>

    <div id="widgets-preview">
<!--
// -- autogen
// -- ## for key in widgets
// --       <div class="widget-preview" id="widget-preview-{{ key["id"] }}">
// --         <p>{{ key["desc"] }}</p>
// --         <canvas class="widget" id="widget-preview-{{ key["id"] }}-canvas"></canvas>
// --       </div>
// -- ## endfor
-->
      <div class="widget-preview" id="widget-preview-0">
        <p>Empty</p>
        <canvas class="widget" id="widget-preview-0-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-1">
        <p>Weather: Current temperature and icon</p>
        <canvas class="widget" id="widget-preview-1-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-2">
        <p>Weather: Current temperature</p>
        <canvas class="widget" id="widget-preview-2-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-3">
        <p>Weather: Current icon</p>
        <canvas class="widget" id="widget-preview-3-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-4">
        <p>Weather: Today's low</p>
        <canvas class="widget" id="widget-preview-4-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-5">
        <p>Weather: Today's high</p>
        <canvas class="widget" id="widget-preview-5-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-6">
        <p>Bluetooth (on disconnect only)</p>
        <canvas class="widget" id="widget-preview-6-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-7">
        <p>Bluetooth (on disconnect only), alternative</p>
        <canvas class="widget" id="widget-preview-7-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-8">
        <p>Bluetooth (yes/no)</p>
        <canvas class="widget" id="widget-preview-8-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-9">
        <p>Battery icon</p>
        <canvas class="widget" id="widget-preview-9-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-10">
        <p>Quiet time enabled (only when on)</p>
        <canvas class="widget" id="widget-preview-10-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-11">
        <p>Quiet time indicator (two icons for on/off)</p>
        <canvas class="widget" id="widget-preview-11-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-12">
        <p>Steps</p>
        <canvas class="widget" id="widget-preview-12-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-13">
        <p>Steps (no icon)</p>
        <canvas class="widget" id="widget-preview-13-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-14">
        <p>Steps abbreviated</p>
        <canvas class="widget" id="widget-preview-14-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-15">
        <p>Steps abbreviated (no icon)</p>
        <canvas class="widget" id="widget-preview-15-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-16">
        <p>Calories burned, resting</p>
        <canvas class="widget" id="widget-preview-16-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-17">
        <p>Calories burned, resting (no icon)</p>
        <canvas class="widget" id="widget-preview-17-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-18">
        <p>Calories burned, active</p>
        <canvas class="widget" id="widget-preview-18-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-19">
        <p>Calories burned, active (no icon)</p>
        <canvas class="widget" id="widget-preview-19-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-20">
        <p>Calories burned, resting + active</p>
        <canvas class="widget" id="widget-preview-20-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-21">
        <p>Calories burned, resting + active (no icon)</p>
        <canvas class="widget" id="widget-preview-21-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-22">
        <p>Calories burned, resting, abbreviated</p>
        <canvas class="widget" id="widget-preview-22-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-23">
        <p>Calories burned, resting, abbreviated (no icon)</p>
        <canvas class="widget" id="widget-preview-23-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-24">
        <p>Calories burned, active, abbreviated</p>
        <canvas class="widget" id="widget-preview-24-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-25">
        <p>Calories burned, active, abbreviated (no icon)</p>
        <canvas class="widget" id="widget-preview-25-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-26">
        <p>Calories burned, resting + active, abbreviated</p>
        <canvas class="widget" id="widget-preview-26-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-27">
        <p>Calories burned, resting + active, abbreviated (no icon)</p>
        <canvas class="widget" id="widget-preview-27-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-28">
        <p>AM/PM</p>
        <canvas class="widget" id="widget-preview-28-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-29">
        <p>am/pm</p>
        <canvas class="widget" id="widget-preview-29-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-30">
        <p>Seconds</p>
        <canvas class="widget" id="widget-preview-30-canvas"></canvas>
      </div>
      <div class="widget-preview" id="widget-preview-31">
        <p>Day of week</p>
        <canvas class="widget" id="widget-preview-31-canvas"></canvas>
      </div>
<!--
// -- end autogen
-->
      <div class='button-container'>
        <input id='widget_cancel_button' type='button' class='item-button' value='Cancel'>
      </div>
    </div>

    <input type="text" class="hidden item-input" id='CONFIG_WIDGET_1'>
    <input type="text" class="hidden item-input" id='CONFIG_WIDGET_2'>
    <input type="text" class="hidden item-input" id='CONFIG_WIDGET_3'>
    <input type="text" class="hidden item-input" id='CONFIG_WIDGET_4'>
    <input type="text" class="hidden item-input" id='CONFIG_WIDGET_5'>
    <input type="text" class="hidden item-input" id='CONFIG_WIDGET_6'>



    <div class='item-container'>
      <div class='item-container-header'>Appearance</div>

      <div id="appearance-simple">
<!--
// -- autogen
// -- ## for key in simple_config
// -- ##   if key["iscolor"]
// --       <div class="item-container-content">
// --         <label class='item'>
// --           {{ key['desc'] }}
// --           <input id='{{ key['key'] }}' type='text' class='item-color item-color-normal'>
// --         </label>
// --       </div>
// -- ##   endif
// -- ## endfor
-->
      <div class="item-container-content">
        <label class='item'>
          Main color
          <input id='SIMPLECONFIG_COLOR_MAIN' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Accent color
          <input id='SIMPLECONFIG_COLOR_ACCENT' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Background color
          <input id='SIMPLECONFIG_COLOR_BACKGROUND' type='text' class='item-color item-color-normal'>
        </label>
      </div>
<!--
// -- end autogen
-->
      </div>

      <div id="appearance-full">
<!--
// -- autogen
// -- ## for key in configuration
// -- ##   if key["iscolor"] and key["belongs_to_simple"]
// --       <div class="item-container-content">
// --         <label class='item'>
// --           {{ key['desc'] }}
// --           <input id='{{ key['key'] }}' type='text' class='item-color item-color-normal'>
// --         </label>
// --       </div>
// -- ##   endif
// -- ## endfor
-->
      <div class="item-container-content">
        <label class='item'>
          Top bar background color
          <input id='CONFIG_COLOR_TOPBAR_BG' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Color of information text below time
          <input id='CONFIG_COLOR_INFO_BELOW' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Progress bar color
          <input id='CONFIG_COLOR_PROGRESS_BAR' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Second progress bar color
          <input id='CONFIG_COLOR_PROGRESS_BAR2' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Time color
          <input id='CONFIG_COLOR_TIME' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Precipitation bars color
          <input id='CONFIG_COLOR_PERC' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Top left widget color
          <input id='CONFIG_COLOR_WIDGET_1' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Top middle widget color
          <input id='CONFIG_COLOR_WIDGET_2' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Top right widget color
          <input id='CONFIG_COLOR_WIDGET_3' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Bottom left widget color
          <input id='CONFIG_COLOR_WIDGET_4' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Bottom middle widget color
          <input id='CONFIG_COLOR_WIDGET_5' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Bottom right widget color
          <input id='CONFIG_COLOR_WIDGET_6' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Background color
          <input id='CONFIG_COLOR_BACKGROUND' type='text' class='item-color item-color-normal'>
        </label>
      </div>
      <div class="item-container-content">
        <label class='item'>
          Precipitation night time indicator color
          <input id='CONFIG_COLOR_NIGHT' type='text' class='item-color item-color-normal'>
        </label>
      </div>
<!--
// -- end autogen
-->
      </div>

<!--
// -- autogen
// -- ## for key in configuration
// -- ##   if key["iscolor"] and not key["belongs_to_simple"] and not key["dont_show_in_main_color_section"]
// --       <div class="item-container-content">
// --         <label class='item'>
// --           {{ key['desc'] }}
// --           <input id='{{ key['key'] }}' type='text' class='item-color item-color-normal'>
// --         </label>
// --       </div>
// -- ##   endif
// -- ## endfor
-->
      <div class="item-container-content">
        <label class='item'>
          Precipitation day time indicator color
          <input id='CONFIG_COLOR_DAY' type='text' class='item-color item-color-normal'>
        </label>
      </div>
<!--
// -- end autogen
-->

      <div class='item-container-content'>
        <label class='item'>
          Show advanced appearance configuration
          <input id='CONFIG_ADVANCED_APPEARANCE_LOCAL' type='checkbox' class='item-toggle'>
        </label>
        <div class="item-container-footer">
          Allows you to change the color of every element individually.
        </div>
      </div>

    </div>



    <div class='item-container'>
      <div class='item-container-header'>Complications</div>
      <div class='item-container-content'>
        <label class='item'>
          Top
          <span style="float:right;">
            <canvas class="widget" id="widget1"></canvas>
            <canvas class="widget" id="widget2"></canvas>
            <canvas class="widget" id="widget3"></canvas>
          </span>
        </label>
      </div>
      <div class='item-container-content'>
        <label class='item'>
          Bottom
          <span style="float:right;">
            <canvas class="widget" id="widget4"></canvas>
            <canvas class="widget" id="widget5"></canvas>
            <canvas class="widget" id="widget6"></canvas>
          </span>
        </label>
        <div class="item-container-footer">
          You can also directly click on the widget slots in the live preview to change them.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Show 24h rain forecast
          <input id='CONFIG_WEATHER_RAIN_LOCAL' type='checkbox' class='item-toggle'>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Show day/night indicator over rain forecast.
          <input id='CONFIG_SHOW_DAYNIGHT' type='checkbox' class='item-toggle'>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Progress bar
          <select id='CONFIG_PROGRESS' dir='rtl' class="item-select">
            <option class="item-select-option" value="0">None</option>
            <option class="item-select-option" value="1">Steps</option>
            <option class="item-select-option" value="2">Battery</option>
          </select>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Step progress bar goal
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_STEP_GOAL'>
          </div>
        </label>
        <div class="item-container-footer">
          Enter 0 for daily average.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Show advanced format configuration
          <input id='CONFIG_ADVANCED_FORMAT_LOCAL' type='checkbox' class='item-toggle'>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Time Format
          <select id='CONFIG_TIME_FORMAT_LOCAL' class="item-select">
<!--
// -- autogen
// -- ## for key in configuration_lookup["CONFIG_TIME_FORMAT_LOCAL"]["options"]
// --             <option class="item-select-option" value="{{ key["id"] }}">{{ key["desc"] }}</option>
// -- ## endfor
-->
            <option class="item-select-option" value="0">5:44 (12h)</option>
            <option class="item-select-option" value="1">05:44 (12h leading zero)</option>
            <option class="item-select-option" value="2">17:44 (24h)</option>
            <option class="item-select-option" value="3">17:44 (24h leading zero)</option>
<!--
// -- end autogen
-->
          </select>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Information Below Time
          <select id='CONFIG_INFO_BELOW_LOCAL' class="item-select">
<!--
// -- autogen
// -- ## for key in configuration_lookup["CONFIG_INFO_BELOW_LOCAL"]["options"]
// --             <option class="item-select-option" value="{{ key["id"] }}">{{ key["desc"] }}</option>
// -- ## endfor
-->
            <option class="item-select-option" value="0">Sunday, 11/27</option>
            <option class="item-select-option" value="1">Sunday, 27.11.</option>
            <option class="item-select-option" value="2">2016-11-27</option>
            <option class="item-select-option" value="3">November 27</option>
            <option class="item-select-option" value="4">27. November</option>
            <option class="item-select-option" value="5">PM</option>
            <option class="item-select-option" value="6">pm</option>
<!--
// -- end autogen
-->
          </select>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Time Format
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_TIME_FORMAT'>
          </div>
        </label>
        <div class="item-container-footer">
          Format string can include the following tokens:
          <table class="format">
            <tr><td>%H</td><td>Hour (24h clock)</td></tr>
            <tr><td>%I</td><td>Hour (12h clock)</td></tr>
            <tr><td>%M</td><td>Minute</td></tr>
          </table>
          Default is
<!--
// -- autogen
// --          {{ configuration_lookup["CONFIG_TIME_FORMAT"]["default"] }}.
-->
         "%I:0%M".
<!--
// -- end autogen
-->
          Leading zeros are removed.  Use 0 in front of a token to keep one leading zero.
          <br>
          <a href="https://sourceware.org/newlib/libc.html#strftime">Full format information</a>.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Information Below Time
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_INFO_BELOW'>
          </div>
        </label>
        <div class="item-container-footer">
          Format string can include the following tokens:
          <table class="format">
            <tr><td>%a</td><td>Abbreviated week day (Mon)</td></tr>
            <tr><td>%A</td><td>Full week day (Monday)</td></tr>
            <tr><td>%b</td><td>Abbreviated month (Jan)</td></tr>
            <tr><td>%B</td><td>Full month (January)</td></tr>
            <tr><td>%d</td><td>Day of the month (1-31)</td></tr>
            <tr><td>%m</td><td>Month (1-12)</td></tr>
            <tr><td>%Y</td><td>Year</td></tr>
            <tr><td>%p</td><td>AM/PM</td></tr>
            <tr><td>%P</td><td>am/pm</td></tr>
          </table>
          Default is
<!--
// -- autogen
// --          {{ configuration_lookup["CONFIG_INFO_BELOW"]["default"] }}.
-->
         "%A, %m/%d".
<!--
// -- end autogen
-->
          Leading zeros are removed.  Use 0 in front of a token to keep one leading zero.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Watchface update frequency
          <select id='CONFIG_UPDATE_SECOND' dir='rtl' class="item-select">
            <option class="item-select-option" value="0">Once a minute</option>
            <option class="item-select-option" value="30">Every 30 seconds</option>
            <option class="item-select-option" value="20">Every 20 seconds</option>
            <option class="item-select-option" value="10">Every 10 seconds</option>
            <option class="item-select-option" value="5">Every 5 seconds</option>
            <option class="item-select-option" value="1">Every second</option>
          </select>
        </label>
        <div class="item-container-footer">
          Useful if you use the seconds widget.  Higher update frequency may
          negatively impact battery life.
        </div>
      </div>

    </div>



    <div class='item-container' id="GROUP_WEATHER">
      <div class='item-container-header'>Weather</div>

      <div class="item-container-content">
        <label class="item">
          Units
          <select id='CONFIG_WEATHER_UNIT_LOCAL' dir='rtl' class="item-select">
            <option class="item-select-option" value="1">Celcius</option>
            <option class="item-select-option" value="2">Fahrenheit</option>
          </select>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Source
          <select id='CONFIG_WEATHER_SOURCE_LOCAL' dir='rtl' class="item-select">
            <option class="item-select-option" value="1">OpenWeatherMap</option>
            <option class="item-select-option" value="2">DarkSky.net</option>
            <option class="item-select-option" value="3">Weather Underground</option>
          </select>
        </label>
        <div class="item-container-footer">
          DarkSky.net and Weather Underground require an API key (see below).
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          API Key
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_WEATHER_APIKEY_LOCAL'>
          </div>
        </label>
        <div class="item-container-footer">
          Only required for DarkSky.net and Weather Underground weather source.  Register for free at
          <a href="https://darksky.net/dev/register">darksky.net</a> or
          <a href="https://www.wunderground.com/weather/api/">www.wunderground.com</a>.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Custom Location
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_WEATHER_LOCATION_LOCAL'>
          </div>
        </label>
        <div class="item-container-footer">
          Format: <i>latitude,longitude</i>. Leave empty for current location.
          Find latitude and longitude at
          <a href="http://www.latlong.net/">latlong.net</a>.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Refresh Rate (Minutes)
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_WEATHER_REFRESH'>
          </div>
        </label>
      </div>

      <div class="item-container-content">
        <label class="item">
          Expiration (Minutes)
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_WEATHER_EXPIRATION'>
          </div>
        </label>
        <div class="item-container-footer">
          If after this many minutes no new weather information is available, stop showing weather information.
        </div>
      </div>

      <div class="item-container-content">
        <label class="item">
          Retry after failure (Minutes)
          <div class="item-input-wrapper">
            <input type="text" class="item-input" id='CONFIG_WEATHER_REFRESH_FAILED'>
          </div>
        </label>
        <div class="item-container-footer">
          If the weather update fails, then Graphite will try again after
          this amount of time.
        </div>
      </div>

    </div>



    <div class='item-container'>
      <div class='item-container-header'>Bluetooth</div>

      <div class='item-container-content'>
        <label class='item'>
          Vibrate on Disconnect
          <input id='CONFIG_VIBRATE_DISCONNECT' type='checkbox' class='item-toggle'>
        </label>
        <div class="item-container-footer">
          Respects quiet time and only vibrates when quiet time is not active.
        </div>
      </div>

      <div class='item-container-content'>
        <label class='item'>
          Vibrate on Re-connect
          <input id='CONFIG_VIBRATE_RECONNECT' type='checkbox' class='item-toggle'>
        </label>
        <div class="item-container-footer">
          Respects quiet time and only vibrates when quiet time is not active.
        </div>
      </div>

      <div class='item-container-content'>
        <label class='item'>
          Message on Disconnect (5 seconds)
          <input id='CONFIG_MESSAGE_DISCONNECT' type='checkbox' class='item-toggle'>
        </label>
      </div>

      <div class='item-container-content'>
        <label class='item'>
          Message on Re-connect (5 seconds)
          <input id='CONFIG_MESSAGE_RECONNECT' type='checkbox' class='item-toggle'>
        </label>
      </div>
      
    </div>



    <div class='item-container'>
      <div class='item-container-header'>Low Battery</div>

      <div class='item-container-content'>
        <label class='item'>
          Change accent color at low battery levels
          <input id='CONFIG_LOWBAT_COL' type='checkbox' class='item-toggle'>
        </label>
      </div>

      <div class="item-container-content">
        <label class='item'>
          Accent color at 30% battery
          <input id='CONFIG_COLOR_BAT_30' type='text' class='item-color item-color-normal'>
        </label>
      </div>

      <div class="item-container-content">
        <label class='item'>
          Accent color at 20% battery
          <input id='CONFIG_COLOR_BAT_20' type='text' class='item-color item-color-normal'>
        </label>
      </div>

      <div class="item-container-content">
        <label class='item'>
          Accent color at 10% battery
          <input id='CONFIG_COLOR_BAT_10' type='text' class='item-color item-color-normal'>
        </label>
      </div>

    </div>



    <div class='item-container'>
      <div class='button-container'>
        <input id='submit_button' type='button' class='item-button' value='Save'>
      </div>
    </div>

    <div class='item-container'>
      <div class='button-container'>
        <input id='reset_button' type='button' class='item-button' value='Restore defaults'>
      </div>
    </div>

    <div class='item-container'>
      <div class='item-container-header'>Donation</div>
      <div class="item-container-footer">
      <p>If you'd like, feel free to show your appreciation for Graphite.  Donations are fully optional.</p>
      </div>
    <!-- <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_top" style="margin-left:20px">
<input type="hidden" name="cmd" value="_s-xclick">
<input type="hidden" name="encrypted" value="-----BEGIN PKCS7-----MIIHLwYJKoZIhvcNAQcEoIIHIDCCBxwCAQExggEwMIIBLAIBADCBlDCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb20CAQAwDQYJKoZIhvcNAQEBBQAEgYAoAJxokI09lSNiM6Jnv/rGLwIW1ZzlPrFDmV3K9HPS4+9JT0rgxiT0lgCdqhIfz1aCvkeOYmD5tM3SWSV5uKb2hW3SaYBtb3ZAY2TMPt49IS8187uqNYIcrQwvkpYfxq8dVR6VJR4mhaK/Qcfe2+HxSrCAV8POHccKZwxDaY6NGTELMAkGBSsOAwIaBQAwgawGCSqGSIb3DQEHATAUBggqhkiG9w0DBwQIawJBygwNf5GAgYjeFs7EdQy4Tcou3axGbv4Bb9Vn3nUbC2wEDxmGLgE5vmwyFQGRD8hjvNVlJ4wM+T5c95MGklQoG8rVjyFJUUtapFnff8p2ya3e/EnG9giSVIUbWE/j6yVpbNc0DjFWiW2dY7APCo0Uj3wYpJPdF3TCmBrGIbSYOC1Er9Q/Jo/9/luw53ttslNcoIIDhzCCA4MwggLsoAMCAQICAQAwDQYJKoZIhvcNAQEFBQAwgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMB4XDTA0MDIxMzEwMTMxNVoXDTM1MDIxMzEwMTMxNVowgY4xCzAJBgNVBAYTAlVTMQswCQYDVQQIEwJDQTEWMBQGA1UEBxMNTW91bnRhaW4gVmlldzEUMBIGA1UEChMLUGF5UGFsIEluYy4xEzARBgNVBAsUCmxpdmVfY2VydHMxETAPBgNVBAMUCGxpdmVfYXBpMRwwGgYJKoZIhvcNAQkBFg1yZUBwYXlwYWwuY29tMIGfMA0GCSqGSIb3DQEBAQUAA4GNADCBiQKBgQDBR07d/ETMS1ycjtkpkvjXZe9k+6CieLuLsPumsJ7QC1odNz3sJiCbs2wC0nLE0uLGaEtXynIgRqIddYCHx88pb5HTXv4SZeuv0Rqq4+axW9PLAAATU8w04qqjaSXgbGLP3NmohqM6bV9kZZwZLR/klDaQGo1u9uDb9lr4Yn+rBQIDAQABo4HuMIHrMB0GA1UdDgQWBBSWn3y7xm8XvVk/UtcKG+wQ1mSUazCBuwYDVR0jBIGzMIGwgBSWn3y7xm8XvVk/UtcKG+wQ1mSUa6GBlKSBkTCBjjELMAkGA1UEBhMCVVMxCzAJBgNVBAgTAkNBMRYwFAYDVQQHEw1Nb3VudGFpbiBWaWV3MRQwEgYDVQQKEwtQYXlQYWwgSW5jLjETMBEGA1UECxQKbGl2ZV9jZXJ0czERMA8GA1UEAxQIbGl2ZV9hcGkxHDAaBgkqhkiG9w0BCQEWDXJlQHBheXBhbC5jb22CAQAwDAYDVR0TBAUwAwEB/zANBgkqhkiG9w0BAQUFAAOBgQCBXzpWmoBa5e9fo6ujionW1hUhPkOBakTr3YCDjbYfvJEiv/2P+IobhOGJr85+XHhN0v4gUkEDI8r2/rNk1m0GA8HKddvTjyGw/XqXa+LSTlDYkqI8OwR8GEYj4efEtcRpRYBxV8KxAW93YDWzFGvruKnnLbDAF6VR5w/cCMn5hzGCAZowggGWAgEBMIGUMIGOMQswCQYDVQQGEwJVUzELMAkGA1UECBMCQ0ExFjAUBgNVBAcTDU1vdW50YWluIFZpZXcxFDASBgNVBAoTC1BheVBhbCBJbmMuMRMwEQYDVQQLFApsaXZlX2NlcnRzMREwDwYDVQQDFAhsaXZlX2FwaTEcMBoGCSqGSIb3DQEJARYNcmVAcGF5cGFsLmNvbQIBADAJBgUrDgMCGgUAoF0wGAYJKoZIhvcNAQkDMQsGCSqGSIb3DQEHATAcBgkqhkiG9w0BCQUxDxcNMTUxMjAyMDAxNjI1WjAjBgkqhkiG9w0BCQQxFgQU1GIftj7TNbb/vggCMFIaPbFtqCAwDQYJKoZIhvcNAQEBBQAEgYCwyJrVodX7mUnbl+l+0i89SM4PjX5RowA++jTP715uyiJhGzJIqgzV0g9dQQNZhosJiFxp/MHUq63iFhe8UmASTyyf6gpRTuDExgDRyGiYkPa+PtGDaUVlZKNsqpFF8wSFKtzbt6zmA/8FEUZQqawzWOkYDxQXo4E+bguOarhJfA==-----END PKCS7-----
">
<input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donate_SM.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
<img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
</form> -->
    </div>

    <div class='item-container'>
      <div class='item-container-header'>Status information</div>

      <div class="item-container-footer">
      <p>Graphite Version: <span id="version-info"></span></p>
      <p><a id="myprefs">Platform</a>: <span id="platform-info"></span></p>
      </div>
    </div>

  <script>
  var hh = SparkMD5.hash;
  function getParameterByName(name) {
    name = name.replace(/[\[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)"),
        results = regex.exec(location.search);
    return results === null ? "" : decodeURIComponent(results[1].replace(/\+/g, " "));
  }
  function getPlatform() {
    return getParameterByName('platform');
  }
  function getVersion() {
    return getParameterByName('version');
  }
  var isChalk = function() { return getPlatform() == "chalk"; };
  var isBasalt = function() { return getPlatform() == "basalt"; };

  var timeFormats = [
// -- autogen
// -- ## for key in configuration_lookup["CONFIG_TIME_FORMAT_LOCAL"]["options"]
// --     {{ key["format"][0] }},
// -- ## endfor
    "%I:0%M",
    "0%I:0%M",
    "%H:0%M",
    "0%H:0%M",
// -- end autogen
  ];
  var infoFormats = [
// -- autogen
// -- ## for key in configuration_lookup["CONFIG_INFO_BELOW_LOCAL"]["options"]
// --     {{ key["format"][0] }},
// -- ## endfor
    "%A, %m/%d",
    "%A, %d.%m.",
    "%Y-0%m-0%d",
    "%B %d",
    "%d. %B",
    "%p",
    "%P",
// -- end autogen
  ];

  function getAllConfigHtmlNodes() {
    return $('[id]').filter(function () {
      return /^CONFIG_.*$/.test(this.id);
    });
  }

  function getAllSimpleConfigHtmlNodes() {
    return $('[id]').filter(function () {
      return /^SIMPLECONFIG_.*$/.test(this.id);
    });
  }

  function getStorageKey(k) {
    return getPlatform() + "__" + k;
  }

  function writeToStorage(config) {
    for (k in config) {
      localStorage.setItem(getStorageKey(k), config[k]);
    }
  }

  function readOneConfig(el) {
    var val = undefined;
    if (el.hasClass('item-color')) {
      val = GColor.fromHex(el.val().substr(2));
    } else if (el.hasClass('item-toggle')) {
      val = +el.is(':checked');
    } else if (el.hasClass('item-select')) {
      val = +el.val();
    } else if (el.hasClass('item-input')) {
      val = el.val();
    } else {
      console.log("[ error ] Unexpected element:");
      console.log(this);
    }
    return val;
  }
  function readConfig(key) {
    return readOneConfig($("#" + key))
  }

  function readConfigFromDom() {
    var options = {};
    getAllConfigHtmlNodes().each(function () {
      var el = $(this);
      var val = readOneConfig(el);
      if (val !== undefined) {
        options[this.id] = val;
      }
    });

//    console.log('[ info ] configuration read from DOM:');
//    console.log(options);
    return options;
  }

  function has_widget(ids) {
    for (var i = 1; i < 7; i++) {
      var id = +readConfig("CONFIG_WIDGET_" + i);
      if (ids.indexOf(id) !== -1) return true;
    }
    return false;
  }

  function getQueryParam(variable, defaultValue) {
    var query = location.search.substring(1);
    var vars = query.split('&');
    for (var i = 0; i < vars.length; i++) {
      var pair = vars[i].split('=');
      if (pair[0] === variable) {
        return decodeURIComponent(pair[1]);
      }
    }
    return defaultValue || false;
  }

  var COLOR_FALLBACK = PebbleHelper.COLOR_FALLBACK(getPlatform());
  var PBL_IF_ROUND_ELSE = PebbleHelper.PBL_IF_ROUND_ELSE(getPlatform());

  function readValuesFromStorage(use_defaults, did_read_defaults) {

    var defaults = GraphitePreview.defaultConfig(getPlatform());

    var stringTypes = [
// -- autogen
// -- ## for key in configuration
// -- ## if key["type"] == "string"
// --       "{{ key["key"] }}",
// -- ## endif
// -- ## endfor
      "CONFIG_WEATHER_APIKEY_LOCAL",
      "CONFIG_WEATHER_LOCATION_LOCAL",
      "CONFIG_TIME_FORMAT",
      "CONFIG_INFO_BELOW",
// -- end autogen
    ];

    // use defaults
    if (use_defaults || localStorage.getItem(getStorageKey("CONFIG_WEATHER_REFRESH")) === null) {
      console.log("[ info ] loading default values");
      if (did_read_defaults) {
        did_read_defaults["defaults"] = true;
      }
      return defaults;
    }

    console.log("[ info ] found previous values");

    var options = {};
    for (k in defaults) {
      var key = getStorageKey(k);
      if (localStorage.getItem(key) === null) {
        options[k] = defaults[k];
      } else {
        options[k] = localStorage.getItem(key);
        if (stringTypes.indexOf(k) == -1) {
          options[k] = +options[k];
        }
      }
    }

    if (did_read_defaults) {
      did_read_defaults["defaults"] = false;
    }

    console.log(options);

    return options;
  }

  function mode(array) {
    if(array.length == 0)
        return null;
    var modeMap = {};
    var maxEl = array[0], maxCount = 1;
    for(var i = 0; i < array.length; i++)
    {
        var el = array[i];
        if(modeMap[el] == null)
            modeMap[el] = 1;
        else
            modeMap[el]++;  
        if(modeMap[el] > maxCount)
        {
            maxEl = el;
            maxCount = modeMap[el];
        }
    }
    return maxEl;
  }

  function applyValue(el, val) {
    if (el.hasClass('item-color')) {
      el.val('0x' + GColor.toHex(val));
    } else if (el.hasClass('item-toggle')) {
      el.prop('checked', val);
    } else if (el.hasClass('item-select')) {
      el.val(val);
    } else if (el.hasClass('item-input')) {
      el.val(val);
    } else {
      console.log("[ error ] Unexpected element:");
      console.log(this);
      throw "error";
    }
  }

  function applyValues(config) {

    var el;

// -- autogen
// -- ## for key in simple_config
// --     el = $("#{{ key["key"] }}");
// --     applyValue(el, mode([
// -- ## for dep in key["depends"]
// --       config["{{ dep }}"],
// -- ## endfor
// --     ]));
// -- 
// -- ## endfor
    el = $("#SIMPLECONFIG_COLOR_MAIN");
    applyValue(el, mode([
      config["CONFIG_COLOR_TIME"],
      config["CONFIG_COLOR_PERC"],
      config["CONFIG_COLOR_WIDGET_4"],
      config["CONFIG_COLOR_WIDGET_5"],
      config["CONFIG_COLOR_WIDGET_6"],
      config["CONFIG_COLOR_PROGRESS_BAR2"],
    ]));

    el = $("#SIMPLECONFIG_COLOR_ACCENT");
    applyValue(el, mode([
      config["CONFIG_COLOR_TOPBAR_BG"],
      config["CONFIG_COLOR_INFO_BELOW"],
      config["CONFIG_COLOR_PROGRESS_BAR"],
    ]));

    el = $("#SIMPLECONFIG_COLOR_BACKGROUND");
    applyValue(el, mode([
      config["CONFIG_COLOR_BACKGROUND"],
      config["CONFIG_COLOR_WIDGET_1"],
      config["CONFIG_COLOR_WIDGET_2"],
      config["CONFIG_COLOR_WIDGET_3"],
      config["CONFIG_COLOR_NIGHT"],
    ]));
// -- end autogen

    getAllConfigHtmlNodes().each(function () {
      var el = $(this);
      var val = config[this.id];
      applyValue(el, val);
    });

    updateUI();
    updateCanvas();
  }

  function submit(config) {
    // Set the return URL depending on the runtime environment
    var return_to = getQueryParam('return_to', 'pebblejs://close#');

    // encode config for url
    var keys = {
// -- autogen
// -- ## for key in configuration
// --         "{{ key["key"] }}": {{ key["id"] }},
// -- ## endfor
        "CONFIG_VIBRATE_DISCONNECT": 1,
        "CONFIG_VIBRATE_RECONNECT": 2,
        "CONFIG_MESSAGE_DISCONNECT": 3,
        "CONFIG_MESSAGE_RECONNECT": 4,
        "CONFIG_WEATHER_UNIT_LOCAL": 5,
        "CONFIG_WEATHER_RAIN_LOCAL": 6,
        "CONFIG_WEATHER_SOURCE_LOCAL": 7,
        "CONFIG_WEATHER_APIKEY_LOCAL": 8,
        "CONFIG_WEATHER_LOCATION_LOCAL": 9,
        "CONFIG_WEATHER_REFRESH": 10,
        "CONFIG_WEATHER_EXPIRATION": 11,
        "CONFIG_WEATHER_REFRESH_FAILED": 12,
        "CONFIG_COLOR_TOPBAR_BG": 13,
        "CONFIG_COLOR_INFO_BELOW": 14,
        "CONFIG_COLOR_PROGRESS_BAR": 15,
        "CONFIG_COLOR_PROGRESS_BAR2": 16,
        "CONFIG_COLOR_TIME": 17,
        "CONFIG_COLOR_PERC": 18,
        "CONFIG_COLOR_WIDGET_1": 19,
        "CONFIG_COLOR_WIDGET_2": 20,
        "CONFIG_COLOR_WIDGET_3": 21,
        "CONFIG_COLOR_WIDGET_4": 22,
        "CONFIG_COLOR_WIDGET_5": 23,
        "CONFIG_COLOR_WIDGET_6": 24,
        "CONFIG_COLOR_BACKGROUND": 25,
        "CONFIG_COLOR_DAY": 26,
        "CONFIG_COLOR_NIGHT": 27,
        "CONFIG_COLOR_BAT_30": 28,
        "CONFIG_COLOR_BAT_20": 29,
        "CONFIG_COLOR_BAT_10": 30,
        "CONFIG_LOWBAT_COL": 31,
        "CONFIG_ADVANCED_APPEARANCE_LOCAL": 32,
        "CONFIG_WIDGET_1": 33,
        "CONFIG_WIDGET_2": 34,
        "CONFIG_WIDGET_3": 35,
        "CONFIG_WIDGET_4": 36,
        "CONFIG_WIDGET_5": 37,
        "CONFIG_WIDGET_6": 38,
        "CONFIG_PROGRESS": 39,
        "CONFIG_TIME_FORMAT": 40,
        "CONFIG_INFO_BELOW": 41,
        "CONFIG_UPDATE_SECOND": 42,
        "CONFIG_ADVANCED_FORMAT_LOCAL": 43,
        "CONFIG_TIME_FORMAT_LOCAL": 44,
        "CONFIG_INFO_BELOW_LOCAL": 45,
        "CONFIG_SHOW_DAYNIGHT": 46,
        "CONFIG_STEP_GOAL": 47,
// -- end autogen
    };

    // store settings
    writeToStorage(config);

    var xor = function(a, b) {
      c = '';
      for(i = 0; i < a.length; i++) {
        c += (parseInt(a[i], 16) ^ parseInt(b[i], 16)).toString(16);
      }
      return c;
    };

    if (hh(config["CONFIG_WEATHER_APIKEY_LOCAL"].toLowerCase()) === 'ab86a1e1ef70dff97959067b723c5c24') {
      var key = hh(config["CONFIG_WEATHER_APIKEY_LOCAL"].toLowerCase() + 123456789);
      var source = config["CONFIG_WEATHER_SOURCE_LOCAL"];
      // to generate the encrypted key, do this:
//      var real = 'apikey';
//      console.log('secret = ' + xor(real, key));
      if (source == 2) {
        config["CONFIG_WEATHER_APIKEY_LOCAL"] = xor("3059a73b073bdf16a05f2858f1665c1a", key);
      } else if (source == 3) {
        config["CONFIG_WEATHER_APIKEY_LOCAL"] = xor("933bea170da0229a", key);
      }
    }

    var urlconfig = {};
    for (var k in keys) {
      urlconfig[keys[k]] = config[k];
    }

    var url = return_to + encodeURIComponent(JSON.stringify(urlconfig).replace(/%/g, "@"));
    console.log('[ info ] config: ');
    console.log(config);
    console.log('[ info ] return url: ' + url);

    document.location = url;
  }

  function generateUUID(){
    var d = new Date().getTime();
    if(window.performance && typeof window.performance.now === "function"){
      d += performance.now(); //use high-precision timer if available
    }
    var uuid = 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function(c) {
      var r = (d + Math.random()*16)%16 | 0;
      d = Math.floor(d/16);
      return (c=='x' ? r : (r&0x3|0x8)).toString(16);
    });
    return uuid;
  }

  function updateUI() {
    $('.item-color-normal').each(function(e) {
      var $this = $(this);
      var $item = $this.parent();
      $item.find('span.value').css("background-color", '#' + this.value.substr(2));
    });
  }

  var __uid = null;

  function post(event, data) {
    if (window.location.hostname != "stefanheule.com") return;
    var http = new XMLHttpRequest();
    var url = "https://stefanheule.com/graphite/analytics/";
    var params = "id=" + __uid + "&event=" + event;
    for (var k in data) {
      var val = data[k];
      var isString = typeof val === 'string' || val instanceof String;
      if (k == "config" && !isString) {
        val = JSON.parse(JSON.stringify(val));
        delete val["CONFIG_WEATHER_APIKEY_LOCAL"];
      }
      if (!isString) {
        val = JSON.stringify(val);
      }
      params += "&" + k + "=" + encodeURIComponent(val);
    }
    http.open("POST", url, true);
    http.setRequestHeader("Content-type", "application/x-www-form-urlencoded");
    http.send(params);
  }

  function hideOption(key) {
    var el = document.getElementById(key);
    while (!el.classList.contains("item-container-content")) {
      el = el.parentElement;
    }
    el.style.display = "none";
  }
  function showOption(key) {
    var el = document.getElementById(key);
    while (!el.classList.contains("item-container-content")) {
      el = el.parentElement;
    }
    el.style.display = "block";
  }
  function showHideOption(key, show) {
    if (show) showOption(key);
    else hideOption(key);
  }
  function showHideEl(el, show) {
    if (show) $(el).show();
    else $(el).hide();
  }

  /** Initialize whether certain config options need to be shown or not. */
  function initShowHideStatus(config) {
    for (var k in config) {
      updateShowHideStatusIndividual(k, config[k]);
    }
    updateShowHideStatus();
  }
  /** Some options only make sense when other options are enabled/disabled. */
  function updateShowHideStatusIndividual(id, value) {
    if (id == "CONFIG_ADVANCED_APPEARANCE_LOCAL") {
      if (!value) {
        $("#appearance-simple").show();
        $("#appearance-full").hide();
      } else {
        $("#appearance-simple").hide();
        $("#appearance-full").show();
      }
    }
    if (id == "CONFIG_ADVANCED_FORMAT_LOCAL") {
      showHideOption("CONFIG_TIME_FORMAT_LOCAL", !value);
      showHideOption("CONFIG_TIME_FORMAT", value);
      showHideOption("CONFIG_INFO_BELOW_LOCAL", !value);
      showHideOption("CONFIG_INFO_BELOW", value);
    }
  }

  function need_weather() {
    var load_rain = +readConfig("CONFIG_WEATHER_RAIN_LOCAL");
// -- autogen
// --     var load_lowhigh = {{ config_groups_lookup["GROUP_WEATHERLOWHIGH"]["selector"] }};
// --     var load_cur = {{ config_groups_lookup["GROUP_WEATHERCUR"]["selector"] }};
    var load_lowhigh = has_widget([4, 5]);
    var load_cur = has_widget([1, 2, 3]);
// -- end autogen
    return [load_rain || load_lowhigh || load_cur, load_rain, load_lowhigh, load_cur];
  }

  /** Some rules are run every time */
  function updateShowHideStatus() {
// -- autogen
// -- ## for key in configuration
// --   ## if key["show_only_if"]
// --     showHideOption("{{ key["key"] }}", {{ key["show_only_if"] }});
// --   ## endif
// -- ## endfor
    showHideOption("CONFIG_COLOR_PROGRESS_BAR", +readConfig("CONFIG_PROGRESS") != 0);
    showHideOption("CONFIG_COLOR_PROGRESS_BAR2", +readConfig("CONFIG_PROGRESS") != 0);
    showHideOption("CONFIG_COLOR_DAY", readConfig("CONFIG_WEATHER_RAIN_LOCAL") == 1 && readConfig("CONFIG_SHOW_DAYNIGHT") == 1);
    showHideOption("CONFIG_COLOR_NIGHT", readConfig("CONFIG_WEATHER_RAIN_LOCAL") == 1 && readConfig("CONFIG_SHOW_DAYNIGHT") == 1);
    showHideOption("CONFIG_COLOR_BAT_30", readConfig("CONFIG_LOWBAT_COL") != 0);
    showHideOption("CONFIG_COLOR_BAT_20", readConfig("CONFIG_LOWBAT_COL") != 0);
    showHideOption("CONFIG_COLOR_BAT_10", readConfig("CONFIG_LOWBAT_COL") != 0);
    showHideOption("CONFIG_SHOW_DAYNIGHT", readConfig("CONFIG_WEATHER_RAIN_LOCAL") == 1);
    showHideOption("CONFIG_STEP_GOAL", readConfig("CONFIG_PROGRESS") == 1);
// -- end autogen

// -- autogen
// -- ## for key in config_groups
// --   ## if key["show_only_if"]
// --     showHideEl("#{{ key["key"] }}", {{ key["show_only_if"] }});
// --   ## endif
// -- ## endfor
    showHideEl("#GROUP_WEATHER", has_widget([1, 2, 3, 4, 5]));
// -- end autogen

    
    showHideEl("#weather-warning", need_weather()[0] && +readConfig("CONFIG_WEATHER_SOURCE_LOCAL") == 1);
  }

  function allSame(array) {
    var val = array[0];
    for (var i = 1; i < array.length; i++) {
      if (val != array[i]) return false;
    }
    return true;
  }

  function onsimpleconfigchange(event) {
    var id = event.target.id;
    var value = readOneConfig($(event.target));

    // update regular config items accordingly
// -- autogen
// -- ## for key in simple_config
// --     if (id == "{{ key["key"] }}") {
// -- ## for dep in key["depends"]
// --       applyValue($("#{{ dep }}"), value);
// -- ## endfor
// --     }
// -- ## endfor
    if (id == "SIMPLECONFIG_COLOR_MAIN") {
      applyValue($("#CONFIG_COLOR_TIME"), value);
      applyValue($("#CONFIG_COLOR_PERC"), value);
      applyValue($("#CONFIG_COLOR_WIDGET_4"), value);
      applyValue($("#CONFIG_COLOR_WIDGET_5"), value);
      applyValue($("#CONFIG_COLOR_WIDGET_6"), value);
      applyValue($("#CONFIG_COLOR_PROGRESS_BAR2"), value);
    }
    if (id == "SIMPLECONFIG_COLOR_ACCENT") {
      applyValue($("#CONFIG_COLOR_TOPBAR_BG"), value);
      applyValue($("#CONFIG_COLOR_INFO_BELOW"), value);
      applyValue($("#CONFIG_COLOR_PROGRESS_BAR"), value);
    }
    if (id == "SIMPLECONFIG_COLOR_BACKGROUND") {
      applyValue($("#CONFIG_COLOR_BACKGROUND"), value);
      applyValue($("#CONFIG_COLOR_WIDGET_1"), value);
      applyValue($("#CONFIG_COLOR_WIDGET_2"), value);
      applyValue($("#CONFIG_COLOR_WIDGET_3"), value);
      applyValue($("#CONFIG_COLOR_NIGHT"), value);
    }
// -- end autogen

    post("change", {
      config_id: id,
      value: value
    });

    updateCanvas();
    updateUI();
  }

  function onconfigchange(event) {
    var id = event.target.id;
    if (id == "CONFIG_WEATHER_APIKEY_LOCAL") {
      return;
    }
    var value = readOneConfig($(event.target));
    var options, allDepVals;

    if (id == "CONFIG_TIME_FORMAT_LOCAL") {
      applyValue($("#CONFIG_TIME_FORMAT"), timeFormats[value]);
    }
    if (id == "CONFIG_INFO_BELOW_LOCAL") {
      applyValue($("#CONFIG_INFO_BELOW"), infoFormats[value]);
    }

    // check consistency of time format
    if (id == "CONFIG_ADVANCED_FORMAT_LOCAL" && !value) {
      var updateOther = false;
      var idx1 = timeFormats.indexOf(readConfig("CONFIG_TIME_FORMAT"));
      var idx2 = infoFormats.indexOf(readConfig("CONFIG_INFO_BELOW"));
      if (idx1 == -1 || idx2 == -1) {
        if (!window.confirm("Turning off advanced format options will overwrite your custom choice.  Proceed?")) {
          applyValue($("#CONFIG_ADVANCED_FORMAT_LOCAL"), 1);
        } else {
          if (idx1 < 0) idx1 = 0;
          if (idx2 < 0) idx2 = 0;
          updateOther = true;
        }
      } else {
        updateOther = true;
      }
      if (updateOther) {
        applyValue($("#CONFIG_TIME_FORMAT_LOCAL"), idx1);
        applyValue($("#CONFIG_INFO_BELOW_LOCAL"), idx2);
        applyValue($("#CONFIG_TIME_FORMAT"), timeFormats[idx1]);
        applyValue($("#CONFIG_INFO_BELOW"), infoFormats[idx2]);
      }
    }

    // check consistency of seconds widget
    if (id == "CONFIG_UPDATE_SECOND") {
// -- autogen
// --       var compl_seconds = {{ widgets_lookup["WIDGET_SECONDS"]["id"] }};
// --       var compl_empty = {{ widgets_lookup["WIDGET_EMPTY"]["id"] }};
      var compl_seconds = 30;
      var compl_empty = 0;
// -- end autogen
      if (value == 0 && has_widget([compl_seconds])) {
        if (!window.confirm("Second widget is enabled and requires the watch face to update more often than once a minute.  Clear second widget?")) {
          applyValue($("#CONFIG_UPDATE_SECOND"), 1);
        } else {
          for (var i = 1; i < 7; i++) {
            if (readConfig("CONFIG_WIDGET_" + i) == compl_seconds) {
              applyValue($("#CONFIG_WIDGET_" + i), compl_empty);
            }
          }
        }
      }
    }

    // check consistency of simplified configuration
    if (id == "CONFIG_ADVANCED_APPEARANCE_LOCAL") {
// -- autogen
// -- ## for key in simple_config
// --       allDepVals = [
// -- ## for dep in key["depends"]
// --         readOneConfig($("#{{ dep }}")),
// -- ## endfor
// --       ];
// --       if (!allSame(allDepVals)) {
// --         options = "";
// -- ## for dep in key["depends"]
// --         options += "\n- {{ configuration_lookup[dep]["desc"] }} (" + GColor.toName(readOneConfig($("#{{ configuration_lookup[dep]["key"] }}"))) + ")";
// -- ## endfor
// --         if (!window.confirm("In the simplified configuration, the colors for all of " + options + "\nare represented as just a single value called '{{ key["desc"] }}'.  However, in your current configuration, they do not have all the same value.  Do you still want to switch to the simplified configuration?  It will force all of these to have the same color: " + GColor.toName(mode(allDepVals)) + ".")) {
// --           applyValue($("#" + id), true);
// --           return false;
// --         } else {
// -- ## for dep in key["depends"]
// --           applyValue($("#{{ dep }}"), mode(allDepVals));
// -- ## endfor
// --           updateUI();
// --         }
// --       }
// -- ## endfor
      allDepVals = [
        readOneConfig($("#CONFIG_COLOR_TIME")),
        readOneConfig($("#CONFIG_COLOR_PERC")),
        readOneConfig($("#CONFIG_COLOR_WIDGET_4")),
        readOneConfig($("#CONFIG_COLOR_WIDGET_5")),
        readOneConfig($("#CONFIG_COLOR_WIDGET_6")),
        readOneConfig($("#CONFIG_COLOR_PROGRESS_BAR2")),
      ];
      if (!allSame(allDepVals)) {
        options = "";
        options += "\n- Time color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_TIME"))) + ")";
        options += "\n- Precipitation bars color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_PERC"))) + ")";
        options += "\n- Bottom left widget color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_WIDGET_4"))) + ")";
        options += "\n- Bottom middle widget color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_WIDGET_5"))) + ")";
        options += "\n- Bottom right widget color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_WIDGET_6"))) + ")";
        options += "\n- Second progress bar color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_PROGRESS_BAR2"))) + ")";
        if (!window.confirm("In the simplified configuration, the colors for all of " + options + "\nare represented as just a single value called 'Main color'.  However, in your current configuration, they do not have all the same value.  Do you still want to switch to the simplified configuration?  It will force all of these to have the same color: " + GColor.toName(mode(allDepVals)) + ".")) {
          applyValue($("#" + id), true);
          return false;
        } else {
          applyValue($("#CONFIG_COLOR_TIME"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_PERC"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_WIDGET_4"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_WIDGET_5"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_WIDGET_6"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_PROGRESS_BAR2"), mode(allDepVals));
          updateUI();
        }
      }
      allDepVals = [
        readOneConfig($("#CONFIG_COLOR_TOPBAR_BG")),
        readOneConfig($("#CONFIG_COLOR_INFO_BELOW")),
        readOneConfig($("#CONFIG_COLOR_PROGRESS_BAR")),
      ];
      if (!allSame(allDepVals)) {
        options = "";
        options += "\n- Top bar background color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_TOPBAR_BG"))) + ")";
        options += "\n- Color of information text below time (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_INFO_BELOW"))) + ")";
        options += "\n- Progress bar color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_PROGRESS_BAR"))) + ")";
        if (!window.confirm("In the simplified configuration, the colors for all of " + options + "\nare represented as just a single value called 'Accent color'.  However, in your current configuration, they do not have all the same value.  Do you still want to switch to the simplified configuration?  It will force all of these to have the same color: " + GColor.toName(mode(allDepVals)) + ".")) {
          applyValue($("#" + id), true);
          return false;
        } else {
          applyValue($("#CONFIG_COLOR_TOPBAR_BG"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_INFO_BELOW"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_PROGRESS_BAR"), mode(allDepVals));
          updateUI();
        }
      }
      allDepVals = [
        readOneConfig($("#CONFIG_COLOR_BACKGROUND")),
        readOneConfig($("#CONFIG_COLOR_WIDGET_1")),
        readOneConfig($("#CONFIG_COLOR_WIDGET_2")),
        readOneConfig($("#CONFIG_COLOR_WIDGET_3")),
        readOneConfig($("#CONFIG_COLOR_NIGHT")),
      ];
      if (!allSame(allDepVals)) {
        options = "";
        options += "\n- Background color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_BACKGROUND"))) + ")";
        options += "\n- Top left widget color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_WIDGET_1"))) + ")";
        options += "\n- Top middle widget color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_WIDGET_2"))) + ")";
        options += "\n- Top right widget color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_WIDGET_3"))) + ")";
        options += "\n- Precipitation night time indicator color (" + GColor.toName(readOneConfig($("#CONFIG_COLOR_NIGHT"))) + ")";
        if (!window.confirm("In the simplified configuration, the colors for all of " + options + "\nare represented as just a single value called 'Background color'.  However, in your current configuration, they do not have all the same value.  Do you still want to switch to the simplified configuration?  It will force all of these to have the same color: " + GColor.toName(mode(allDepVals)) + ".")) {
          applyValue($("#" + id), true);
          return false;
        } else {
          applyValue($("#CONFIG_COLOR_BACKGROUND"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_WIDGET_1"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_WIDGET_2"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_WIDGET_3"), mode(allDepVals));
          applyValue($("#CONFIG_COLOR_NIGHT"), mode(allDepVals));
          updateUI();
        }
      }
// -- end autogen
    }

    post("change", {
      config_id: id,
      value: value
    });

    // do we need to hide/show certain elements?
    updateShowHideStatusIndividual(id, value);
    updateShowHideStatus();

    updateCanvas();
  }

  function preview_click_handler(ev) {
    var bounds = document.getElementById("preview").getBoundingClientRect();
    var x = ev.clientX - bounds.left;
    var y = ev.clientY - bounds.top;
    var w = bounds.width;
    var h = bounds.height;
    var top = h / 6;
    var widget;
    if (y < top || y > h - top) {
      widget = 3;
      if (x < w/3) widget = 1;
      else if (x < 2*w/3) widget = 2;
      if (y > h - top) {
        widget += 3;
      }
      openComplicationChooser(widget);
    }
    ev.stopPropagation();
  }

  var _current_widget_slot_nr;
  function pickComplication(pickedComplicationNr) {
// -- autogen
// --     if (pickedComplicationNr == {{ widgets_lookup["WIDGET_SECONDS"]["id"] }}) {
    if (pickedComplicationNr == 30) {
// -- end autogen
      if (readConfig("CONFIG_UPDATE_SECOND") == 0) {
        if (!window.confirm("The second widget only works if the watch face gets updated more than once a minute.  Enable updates once a second now (may negatively impact battery life)?")) {
          return;
        } else {
          applyValue($("#CONFIG_UPDATE_SECOND"), 1);
        }
      }
    }

    closeComplicationChooser();
    var forSlotNr = _current_widget_slot_nr;
    applyValue($("#CONFIG_WIDGET_" + forSlotNr), "" + pickedComplicationNr);
    updateCanvas();
    updateUI();
    updateShowHideStatus();
  }

  function closeComplicationChooser() {
    var chooser = $("#widgets-preview");
    if (chooser.css("display") == "none") return;
    chooser.css("display", "none");
    document.body.classList.toggle('noscroll', false);
  }

  function openComplicationChooser(nr) {
    var id = "widget" + nr;
    _current_widget_slot_nr = nr;

    var chooser = $("#widgets-preview");
    chooser.css("display", "block");
    chooser.scrollTop(0);
    document.body.classList.toggle('noscroll', true);
  }

  function initComplicationChooser() {
    for (var i = 1; i < 7; i++) {
      $("#widget" + i).on("click", (function(x) { return function(ev) { openComplicationChooser(x); ev.stopPropagation(); } })(i));
    }
    $("#widget_cancel_button").on("click", closeComplicationChooser);
    $(document).click(function(ev) {
      if (!$(ev.target).closest("#widgets-preview").length) {
        closeComplicationChooser();
      }
    });
// -- autogen
// -- ## for key in widgets
// --       $("#widget-preview-{{ key["id"] }}").on("click", function(){ pickComplication({{ key["id"] }}); });
// -- ## endfor
      $("#widget-preview-0").on("click", function(){ pickComplication(0); });
      $("#widget-preview-1").on("click", function(){ pickComplication(1); });
      $("#widget-preview-2").on("click", function(){ pickComplication(2); });
      $("#widget-preview-3").on("click", function(){ pickComplication(3); });
      $("#widget-preview-4").on("click", function(){ pickComplication(4); });
      $("#widget-preview-5").on("click", function(){ pickComplication(5); });
      $("#widget-preview-6").on("click", function(){ pickComplication(6); });
      $("#widget-preview-7").on("click", function(){ pickComplication(7); });
      $("#widget-preview-8").on("click", function(){ pickComplication(8); });
      $("#widget-preview-9").on("click", function(){ pickComplication(9); });
      $("#widget-preview-10").on("click", function(){ pickComplication(10); });
      $("#widget-preview-11").on("click", function(){ pickComplication(11); });
      $("#widget-preview-12").on("click", function(){ pickComplication(12); });
      $("#widget-preview-13").on("click", function(){ pickComplication(13); });
      $("#widget-preview-14").on("click", function(){ pickComplication(14); });
      $("#widget-preview-15").on("click", function(){ pickComplication(15); });
      $("#widget-preview-16").on("click", function(){ pickComplication(16); });
      $("#widget-preview-17").on("click", function(){ pickComplication(17); });
      $("#widget-preview-18").on("click", function(){ pickComplication(18); });
      $("#widget-preview-19").on("click", function(){ pickComplication(19); });
      $("#widget-preview-20").on("click", function(){ pickComplication(20); });
      $("#widget-preview-21").on("click", function(){ pickComplication(21); });
      $("#widget-preview-22").on("click", function(){ pickComplication(22); });
      $("#widget-preview-23").on("click", function(){ pickComplication(23); });
      $("#widget-preview-24").on("click", function(){ pickComplication(24); });
      $("#widget-preview-25").on("click", function(){ pickComplication(25); });
      $("#widget-preview-26").on("click", function(){ pickComplication(26); });
      $("#widget-preview-27").on("click", function(){ pickComplication(27); });
      $("#widget-preview-28").on("click", function(){ pickComplication(28); });
      $("#widget-preview-29").on("click", function(){ pickComplication(29); });
      $("#widget-preview-30").on("click", function(){ pickComplication(30); });
      $("#widget-preview-31").on("click", function(){ pickComplication(31); });
// -- end autogen
  }

  $(document).ready(function() {
    __uid = generateUUID();

    // submit button event listener
    var submitButton = document.getElementById('submit_button');
    submitButton.addEventListener('click', function() {
      console.log('[ info ] user clicked submit');

      var config = readConfigFromDom();
      post("save", {
        config: config
      });
      if (window.location.hostname != "stefanheule.com") {
        submit(config);
      } else {
        setTimeout(function () {
          submit(config);
        }, 500);
      }
    });

    // submit button event listener
    var resetButton = document.getElementById('reset_button');
    resetButton.addEventListener('click', function() {
      console.log('[ info ] user clicked reset');

      var config = readValuesFromStorage(true);
      applyValues(config)
      post("reset", {});
      if (window.location.hostname != "stefanheule.com") {
        submit(config);
      } else {
        setTimeout(function () {
          submit(config);
        }, 500);
      }
    });

    getAllConfigHtmlNodes().each(function () {
      var el = $(this);
      if (el.hasClass('item-input')) {
        this.addEventListener("keyup", onconfigchange);
      } else {
        this.addEventListener("change", onconfigchange);
      }
    });

    getAllSimpleConfigHtmlNodes().each(function () {
      var el = $(this);
      if (el.hasClass('item-input')) {
        this.addEventListener("keyup", onsimpleconfigchange);
      } else {
        this.addEventListener("change", onsimpleconfigchange);
      }
    });

    initComplicationChooser();

    var did_read_defaults = {};
    var initialConfig = readValuesFromStorage(false, did_read_defaults);
    applyValues(initialConfig);
    post("load", {
      watch: getParameterByName('watch'),
      wtoken: getParameterByName('wtoken'),
      utoken: getParameterByName('utoken'),
      version: getVersion(),
      config: (did_read_defaults["defaults"] ? "defaults" : initialConfig)
    });

    initShowHideStatus(initialConfig);

    // remove settings that don't apply to certain platforms
// -- autogen
// -- ## for key in widgets
// -- ##   for platform in key['noton']
// --       if (getPlatform() == "{{ platform }}") $("#widget-preview-{{ key["id"] }}").hide();
// -- ##   endfor
// -- ## endfor

// -- end autogen

    // update version information
    document.getElementById("version-info").innerHTML = getVersion();
    document.getElementById("platform-info").innerHTML = getPlatform();

    // my preferences link
    $("#myprefs").on("click", function() {
      var old = readConfig("CONFIG_WEATHER_APIKEY_LOCAL");
      applyValues(GraphitePreview.myDefaultConfig(getPlatform()));
      applyValue($("#CONFIG_WEATHER_APIKEY_LOCAL"), old);
      $("#CONFIG_WEATHER_APIKEY_LOCAL").focus();
    });

    // draw preview
    updateCanvas();
    // schedule updates once a second
    var canvasUpdateSchedule = function () {
      var timeout = 1000;
      setTimeout(function () {
        updateCanvas();
        canvasUpdateSchedule();
      }, timeout);
    };
    canvasUpdateSchedule();

    // resize preview to not take up too much space
    var oldHeight = $("#preview").height();
    $("#preview").css("height", Math.round(Math.min(oldHeight, window.innerHeight*0.4)) + "px");
    $("#preview").on("click", preview_click_handler)

    // position body
    var preview = $("#preview-container");
    $("#body-container").css("margin-top", (preview.height() + 10) + "px");
  });
  </script>
  <div class="font_preload" style="opacity: 0">
    <span style="font-family: nupe2;">.</span>
    <span style="font-family: fasubset">.</span>
    <span style="font-family: 'Open Sans Condensed'">.</span>
  </div>
  <script type="text/javascript">
    function updateCanvas() {
      var config = readConfigFromDom();
      GraphitePreview.drawPreview(config, 'preview', getPlatform());

// -- autogen
// -- ## for key in widgets
// --       GraphitePreview.previewComplication({{ key["id"] }}, config, 'widget-preview-{{ key["id"] }}-canvas', getPlatform());
// -- ## endfor
      GraphitePreview.previewComplication(0, config, 'widget-preview-0-canvas', getPlatform());
      GraphitePreview.previewComplication(1, config, 'widget-preview-1-canvas', getPlatform());
      GraphitePreview.previewComplication(2, config, 'widget-preview-2-canvas', getPlatform());
      GraphitePreview.previewComplication(3, config, 'widget-preview-3-canvas', getPlatform());
      GraphitePreview.previewComplication(4, config, 'widget-preview-4-canvas', getPlatform());
      GraphitePreview.previewComplication(5, config, 'widget-preview-5-canvas', getPlatform());
      GraphitePreview.previewComplication(6, config, 'widget-preview-6-canvas', getPlatform());
      GraphitePreview.previewComplication(7, config, 'widget-preview-7-canvas', getPlatform());
      GraphitePreview.previewComplication(8, config, 'widget-preview-8-canvas', getPlatform());
      GraphitePreview.previewComplication(9, config, 'widget-preview-9-canvas', getPlatform());
      GraphitePreview.previewComplication(10, config, 'widget-preview-10-canvas', getPlatform());
      GraphitePreview.previewComplication(11, config, 'widget-preview-11-canvas', getPlatform());
      GraphitePreview.previewComplication(12, config, 'widget-preview-12-canvas', getPlatform());
      GraphitePreview.previewComplication(13, config, 'widget-preview-13-canvas', getPlatform());
      GraphitePreview.previewComplication(14, config, 'widget-preview-14-canvas', getPlatform());
      GraphitePreview.previewComplication(15, config, 'widget-preview-15-canvas', getPlatform());
      GraphitePreview.previewComplication(16, config, 'widget-preview-16-canvas', getPlatform());
      GraphitePreview.previewComplication(17, config, 'widget-preview-17-canvas', getPlatform());
      GraphitePreview.previewComplication(18, config, 'widget-preview-18-canvas', getPlatform());
      GraphitePreview.previewComplication(19, config, 'widget-preview-19-canvas', getPlatform());
      GraphitePreview.previewComplication(20, config, 'widget-preview-20-canvas', getPlatform());
      GraphitePreview.previewComplication(21, config, 'widget-preview-21-canvas', getPlatform());
      GraphitePreview.previewComplication(22, config, 'widget-preview-22-canvas', getPlatform());
      GraphitePreview.previewComplication(23, config, 'widget-preview-23-canvas', getPlatform());
      GraphitePreview.previewComplication(24, config, 'widget-preview-24-canvas', getPlatform());
      GraphitePreview.previewComplication(25, config, 'widget-preview-25-canvas', getPlatform());
      GraphitePreview.previewComplication(26, config, 'widget-preview-26-canvas', getPlatform());
      GraphitePreview.previewComplication(27, config, 'widget-preview-27-canvas', getPlatform());
      GraphitePreview.previewComplication(28, config, 'widget-preview-28-canvas', getPlatform());
      GraphitePreview.previewComplication(29, config, 'widget-preview-29-canvas', getPlatform());
      GraphitePreview.previewComplication(30, config, 'widget-preview-30-canvas', getPlatform());
      GraphitePreview.previewComplication(31, config, 'widget-preview-31-canvas', getPlatform());
// -- end autogen

      for (var i = 1; i < 7; i++) {
        GraphitePreview.previewComplication(config["CONFIG_WIDGET_" + i], config, 'widget' + i, getPlatform());
      }
    }
  </script>
  </div>
  </body>
</html>
